<mvc:View controllerName="devepos.qdrt.controller.Entity"
    xmlns:app="devepos.qdrt.control"
    xmlns:l="sap.ui.layout"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:f="sap.f"
    xmlns:vm="sap.ui.comp.variants"
    xmlns:table="sap.ui.table"
    xmlns:core="sap.ui.core"
    xmlns="sap.m"
    height="100%">

    <f:DynamicPage fitContent="true"
        class="sapUiNoContentPadding">
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title text="Entity {/name}"></Title>
                </f:heading>
                <f:actions>
                    <SegmentedButton visible="{ui>/sideContentVisible}"
                        selectedKey="{ui>/activeSideContent}">
                        <items>
                            <SegmentedButtonItem icon="sap-icon://filter"
                                key="filter"
                                tooltip="{i18n>entity_customizationPanel_filter_title}"/>
                            <SegmentedButtonItem icon="sap-icon://action-settings"
                                key="column"
                                visible="false"/>
                            <SegmentedButtonItem icon="sap-icon://sort"
                                key="sort"
                                visible="false"/>
                            <SegmentedButtonItem icon="sap-icon://group-2"
                                key="group"
                                visible="false"/>
                        </items>
                    </SegmentedButton>
                    <ToggleButton icon="sap-icon://customize"
                        pressed="{ui>/sideContentVisible}"
                        type="Transparent" />
                </f:actions>
            </f:DynamicPageTitle>
        </f:title>

        <f:content>
            <app:ToggleableSideContent sideContentVisible="{ui>/sideContentVisible}"
                sideContentPosition="End">
                <app:content>
                    <Panel height="100%">
                        <table:Table id="dataPreviewTable"
                            rows="{/rows}"
                            columnMove="onColumnMove"
                            beforeOpenContextMenu="onCellContextMenu"
                            visibleRowCountMode="Auto">
                            <table:extension>
                                <OverflowToolbar class="sapMTBHeader-CTX">
                                    <Title text="{i18n>entity_table_title} ({/rows/length})"
                                        titleStyle="H4"/>
                                    <ToolbarSeparator />
                                    <vm:VariantManagement id="variantManagement"
                                        useFavorites="true"
                                        showShare="true"
                                        showSetAsDefault="true"
                                        showExecuteOnSelection="true"
                                        variantItems="{/variants}">
                                        <vm:variantItems>
                                            <vm:VariantItem author="{author}"
                                                key="{key}"
                                                text="{text}"
                                                executeOnSelection="{executeOnSelection}"
                                                favorite="{favorite}"
                                                global="{global}"
                                                labelReadOnly="{labelReadOnly}"
                                                readOnly="{readOnly}"/>
                                        </vm:variantItems>
                                    </vm:VariantManagement>
                                    <ToolbarSpacer />
                                    <Label text="{i18n>entity_table_tb_maxRows}"
                                        labelFor="maxRowsInput"/>
                                    <Input value="500"
                                        id="maxRowsInput"
                                        width="5rem">
                                    </Input>
                                    <ToolbarSeparator />
                                    <Button type="Transparent"
                                        press="onTableSettings"
                                        icon="sap-icon://action-settings"></Button>
                                    <Button text="{i18n>entity_table_tb_refresh}"
                                        icon="sap-icon://refresh"
                                        type="Emphasized"
                                        press="onUpdateData" />
                                </OverflowToolbar>
                            </table:extension>
                            <table:contextMenu>
                                <Menu />
                            </table:contextMenu>
                        </table:Table>
                    </Panel>
                </app:content>
                <app:sideContent>
                    <app:CustomizationPanel visible="{= ${ui>/activeSideContent} === 'filter'}"
                        title="{i18n>entity_customizationPanel_filter_title}"
                        icon="sap-icon://filter">
                        <!-- Create panel for CDS parameters-->
                        <app:SideFilterPanel headerText="{i18n>entity_sideFilterPanel_title}"
                            availableFilterMetadata="{/metadata/colMetadata}"/>
                    </app:CustomizationPanel>
                </app:sideContent>
            </app:ToggleableSideContent>
        </f:content>
    </f:DynamicPage>
</mvc:View>